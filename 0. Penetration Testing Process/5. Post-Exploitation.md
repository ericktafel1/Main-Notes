 * The `Post-Exploitation` stage aims to obtain sensitive and security-relevant information from a local perspective and business-relevant information that, in most cases, requires higher privileges than a standard user. This stage includes the following components:
	* Evasive Testing
	* Information Gathering
	* Pillaging
	* Vulnerability Assessment
	* Privilege Escalation
	* Persistence
	* Data Exfiltration

---
### Evasive Testing

* Evasive testing is divided into three different categories:
	* Evasive
	* Hybrid Evasive
	* Non-Evasive

---
### Information Gathering

* In the `Post-Exploitation` stage, we go through the `Information Gathering` and `Vulnerability Assessment` stages again, which we can consider as parts of the current stage. This is because the information we had up to this point was gathered from an external perspective, not an internal one.
* The difference here is that we also enumerate the local network and local services such as printers, database servers, virtualization services, etc. Often we will find shares intended for employees to use to exchange and share data and files. The investigation of these services and network components is called `Pillaging`.

---
### Pillaging

* Pillaging is the stage where we examine the role of the host in the corporate network. We analyze the network configurations, including but not limited to:
	* Interfaces
	* ARP
	* IP Subnets
	* Routing
	* Services
	* Shares
	* DNS
	* VPN
	* Network Traffic
* During the pillaging stage, we will also hunt for sensitive data such as passwords on shares, local machines, in scripts, configuration files, password vaults, documents (Excel, Word, .txt files, etc.), and even email.
* Our main goals with pillaging are to show the impact of successful exploitation and, if we have not yet reached the goal of the assessment, to find additional data such as passwords that can be inputs to other stages such as lateral movement.

---
### Persistence

* Maintaining access to the exploited host. This way, if the connection is interrupted, we can still access it. This step is essential and often used as the first step before the `Information Gathering` and `Pillaging` stages.

---
### Vulnerability Assessment

* If we can maintain access and have a good overview of the system, we can use the information about the system and its services and any other data stored on it to repeat the `Vulnerability Assessment` stage, but this time from inside the system. We analyze the information and prioritize it accordingly. The goal we pursue next is the escalation of privileges (if not already in place).

---
### Privilege Escalation

* Getting the highest possible privileges on the system or domain is often crucial. Therefore we want to get the privileges of the `root` (on `Linux-based` systems) or the domain `administrator`/`local administrator`/`SYSTEM` (on `Windows-based` systems) because this will often allow us to move through the entire network without any restrictions.
* However, it is essential to remember that the escalation of privileges does not always have to occur locally on the system. We can also obtain stored credentials during the information gathering stage from other users who are members of a higher privileged group. Exploiting these privileges to log in as another user is also part of privilege escalation because we have escalated our privileges (quickly) using the new set of credentials.

---
### Data Exfiltration

* This means we try to transfer this information from the target system to our own. Security systems such as `Data Loss Prevention` (`DLP`) and `Endpoint Detection and Response` (`EDR`) help detect and prevent data exfiltration. In addition to `Network Monitoring`, many companies use encryption on hard drives to prevent external parties from viewing such information.
* Before exfiltrating any actual data, we should check with the customer and our manager. It can often be enough to create some bogus data (such as fake credit card numbers or social security numbers) and exfiltrate it to our system. That way, the protection mechanisms that look for patterns in data leaving the network will be tested, but we will not be responsible for any live sensitive data on our testing machine.
* Companies must adhere to data security regulations depending on the type of data involved. These include, but are not limited to:

|**Type of Information**|**Security Regulation**|
|---|---|
|Credit Card Account Information|`Payment Card Industry` (`PCI`)|
|Electronic Patient Health Information|`Health Insurance Portability and Accountability Act` (`HIPAA`)|
|Consumers Private Banking Information|`Gramm-Leach-Bliley` (`GLBA`)|
|Government Information|`Federal Information Security Management Act of 2002` (`FISMA`)|

* Some frameworks companies may follow include:
	* NIST
	* ISO
	* GDPR
	* FedRAMP
	* AICPA
	* CIS Controls
	* PCI-DSS
	* COBIT
	* ITAR
	* NERC CIP Standards
* We should check with the client to ensure that their systems are intended to catch the fake data type that we attempt to exfiltrate if we are successful, so we do not misrepresent anything in our report.
* It's a good habit to run a screen recording (along with taking screenshots) as additional evidence for such vital steps. If we only have terminal access, we can display the hostname, IP address, user name, and the corresponding path to the customer file and take a screenshot or screen capture. This helps us prove where the data originated from and that we could remove it from the environment successfully.